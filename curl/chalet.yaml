name: libsof
version: "0.1.3"
externalDependencies:
  curl:
    repository: https://github.com/curl/curl
    tag: curl-8_11_0
    kind: git

targets:
  curl:
    kind: cmakeProject
    location: ${external:${name}}
    recheck: false
    rebuild: false
    defines:
      # - CMAKE_THREAD_PREFER_PTHREAD=ON
      - CMAKE_ARCHIVE_OUTPUT_DIRECTORY=lib/${env:PLATFORM}
      # - ENABLE_BITCODE=OFF
      - CMAKE_BUILD_TYPE=Release
      # - BUILD_DEPENDENCIES=ON
      - USE_NGHTTP2=OFF
      - USE_LIBIDN2=OFF
      - CURL_USE_LIBSSH2=OFF
      - CURL_USE_LIBPSL=OFF
      - CURL_DISABLE_LDAP=ON
      - BUILD_CURL_EXE=OFF
      - BUILD_EXAMPLES=OFF
      - BUILD_SHARED_LIBS=ON

      - CMAKE_USE_OPENSSL=ON
      - CMAKE_INSTALL_INCLUDEDIR=include
      - CMAKE_INCLUDE_OUTPUT_DIRECTORY=include

      # - USE_RESOLVE_ON_IPS=OFF
      # - ENABLE_ARES=OFF
      # - ENABLE_STRICT_TRY_COMPILE=ON
      # - HAVE_GETPASS_R=0
      # - CMAKE_CXX_EXTENSIONS=OFF
      # - CMAKE_IGNORE_PATH=/opt/homebrew
      # - CMAKE_FIND_PACKAGE_NO_PACKAGE_REGISTRY=ON
      # - CURL_STATICLIB=ON
      # - BUILD_STATIC_LIBS=ON
      # - ENABLE_UNICODE=ON
      # - CMAKE_INSTALL_PREFIX=Release
      # - HAVE__FSEEKI64=OFF
      # - CMAKE_USE_SYSTEM_CURL=OFF
      # - ENABLE_ARC=ON
      # - CMAKE_POSITION_INDEPENDENT_CODE=TRUE
      # - ENABLE_VISIBILITY=ON
      # - ENABLE_UNIX_SOCKETS=OFF
      # - HAVE_LIBSOCKET=OFF
      # - CMAKE_MACOSX_BUNDLE=OFF
      # - CURL_DISABLE_POP3=ON
      # - CURL_CA_FALLBACK=ON
      # - CURL_DISABLE_IMAP=ON
      # - ENABLE_WEBSOCKETS=ON
      # - ENABLE_UNIX_SOCKETS=ON
      # - CURL_BROTLI=OFF
      # - ENABLE_VERBOSE=ON
      # - ENABLE_THREADED_RESOLVER=ON
      # - ENABLE_IPV6=OFF
      # - CMAKE_CXX_FLAGS="-mmacosx-version-min=11.0 -O3 -fno-omit-frame-pointer -fPIC -DOPENSSL_NO_HEARTBEATS -DUSE_PTHREADS=1 -Wno-error=implicit-function-declaration" \
      # - CMAKE_C_FLAGS="-mmacosx-version-min=11.0 -O3 -fno-omit-frame-pointer -fPIC -DOPENSSL_NO_HEARTBEATS -DUSE_PTHREADS=1 -Wno-error=implicit-function-declaration"

      # - OPENSSL_IS_BORINGSSL=TRUE
      # - CMAKE_IGNORE_PATH=/opt/homebrew/Cellar/openssl@3/3.4.0/lib/
      # - OPENSSL_ROOT_DIR=${externalBuild:boringssl}
      #
      #
      # FIXME:- VOLTAR
      # - CMAKE_OSX_ARCHITECTURES=x86_64;arm64
      - DEPLOYMENT_TARGET=11.0
      - CMAKE_OSX_DEPLOYMENT_TARGET=11.0
    # defines[platform:macos]:
    # - CMAKE_OSX_ARCHITECTURES=x86_64;arm64
    # - DEPLOYMENT_TARGET=11.0
    # - CMAKE_OSX_DEPLOYMENT_TARGET=11.0

distribution:
  curl:
    kind: archive
    format: zip
    include:
      - ${external:${name}}/LICENSE**
      - ${external:${name}}/include
      # - ${externalBuild:${name}}/include
      - ${externalBuild:${name}}/lib/lib
    # include[:!windows]:
    #   - ${externalBuild:${name}}/lib/${ar:${name}}
    # include[:windows]:
    #   - ${externalBuild:${name}}/lib/**.lib
